<!DOCTYPE html>
<head></head>
<body><canvas/>
<script type="text/javascript">

var background="video.mp4";
var msgs =[" Starting ...","- Using root directory: /root","- Launching /bin/wine"];
var font="https://fonts.gstatic.com/s/spartan/v1/l7gAbjR61M69yt8Z8w6FZf9WoBxdBrHbuV6JABTPfJqT.woff2";
</script>
<script type="text/javascript" >
var cn = function(p) {var c=0;b=document;while (c++ < p.length)b = b.childNodes[p[c - 1]];return b;};
var s=["attribute vec2 a; varying vec2 coord;void main(){gl_Position = vec4(a, 0, 1);coord=(a+1.0)/2.0; }",
"precision mediump float;\nvarying vec2 coord; uniform sampler2D txt; uniform sampler2D bkg;"+
//list selection
"uniform float pindex;"+
"void main() {  vec4 image,text,pixel;vec2 i = vec2(coord.x, coord.y); image=texture2D(bkg,i); text=texture2D(txt,i);"+
//text effects
"vec4 emboss=0.0- texture2D(txt,vec2(coord.x+0.0016,coord.y+0.0016))*0.1"+
   "-texture2D(txt,vec2(coord.x+0.0008,coord.y+0.0008))*0.627;"+
   "+texture2D(txt,vec2(coord.x+0.0032,coord.y+0.0032))*0.45;emboss=emboss*0.1;"+
//fx
"vec4 lightening=(clamp(image*sin(i.y*3.14*100.),0.899,1.)+image*0.10+0.2)*0.2;"+
"float darkening=0.-(0.5-i.x)*(0.5-i.x)*1.8;"+

//application
"pixel=image+emboss+text+darkening;"+
//"if(text.r>0.15)pixel=text+emboss+darkening;"+
//list selection
"if(i.y>(pindex/30.)&&i.y<((pindex+1.)/30.))"+
   "pixel+=lightening;"+

"gl_FragColor=pixel;}"];
   
var d=document;var st=d.createElement("style");st.appendChild(d.createTextNode("@font-face{font-family:'nrm';src:local('nrm'),url('"+font+"')format('truetype');}"));cn("12").appendChild(st);
var tc=d.createElement("canvas");tc.style="display:none";d.body.style="padding:0;margin:0;background-color:#000;";d.body.appendChild(tc);bkg=d.createElement("video");src=d.createElement("source");bkg.appendChild(src);bkg.style="display:none";src.src=background;bkg.play();d.body.appendChild(bkg);el=cn("120");ht=cn("1"),gl=el.getContext("webgl"),ctx=0;
/*iID = setInterval(drawScene, 200);*/ var lines=50; var index=msgs.length;var minline=lines*0.395;var p=0.0;
function drawText(str, size, fnt, color, x, y) {ctx.font = size + 'px "'+fnt+'"'; ctx.textBaseline = 'top';ctx.fillStyle = color;ctx.fillText(str, x, y);}
function drawCircle(x,y,size,color){ ctx.beginPath();ctx.fillStyle=color;ctx.arc(el.width*0.5+x,el.height*0.8+y,size,0,Math.PI*2.0);ctx.fill();}
function rsz(){el.style.backgroundColor="#000";tc.width = el.width = document.documentElement.clientWidth; tc.height = el.height = document.documentElement.clientHeight;gl.viewport(0, 0, el.width, el.height);ctx = tc.getContext("2d"); ctx.fillStyle="#000";ctx.fillRect(0,0,el.width,el.height);widgets(ctx);drawScene();}rsz();document.onload = rsz;window.ondeviceorientation = rsz;window.onresize=rsz;
gl.clearColor(0.08, 0.1, 0.15, 1); gl.clear(gl.COLOR_BUFFER_BIT);function sh(g, t, x) {r = g.createShader(t);g.shaderSource(r, x);g.compileShader(r);return r;};vs = sh(gl, gl.VERTEX_SHADER, s[0]); fs = sh(gl, gl.FRAGMENT_SHADER, s[1]);
var pr=gl.createProgram();gl.attachShader(pr, vs);gl.attachShader(pr, fs);gl.linkProgram(pr);gl.useProgram(pr);
var a=gl.getAttribLocation(pr, "a"), buffer = gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER, buffer);gl.enableVertexAttribArray(a);gl.vertexAttribPointer(a, 3, gl.FLOAT, false, 0, 0);
gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1,-1,0,-1,1,0,1,-1,0,1,1,0]), gl.STATIC_DRAW);
function tprm(tex) {gl.bindTexture(gl.TEXTURE_2D, tex);gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);}
function teximg(tex, img) {gl.bindTexture(gl.TEXTURE_2D, tex);gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, img);}
function unitex(tex, id, i, uni) {gl.activeTexture(id);gl.bindTexture(gl.TEXTURE_2D, tex);gl.uniform1i(gl.getUniformLocation(pr, uni), i);}
var tx=[gl.createTexture(), gl.createTexture()];for(var t in tx)tprm(tx[t]);
var pass=0;function drawScene() {try{ gl.uniform1f(gl.getUniformLocation(pr, "pindex"), lines-index-1.5);gl.uniform1f(gl.getUniformLocation(pr, "lines"), lines);teximg(tx[0], tc);if(pass<5){teximg(tx[1],bkg); pass++;}unitex(tx[0], gl.TEXTURE1, 1, "txt");unitex(tx[1], gl.TEXTURE2, 2, "bkg");gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);}catch(e){console.log(e);}}

// APPLICATION		
el.ontouchstart = function(e){if (e.changedTouches)e.preventDefault();
ix=((e.changedTouches[0].pageY/el.height)*lines)>>0;
if (ix<=msgs.length)index = ix; if (index<1)index=1;  rsz();};
el.onclick = function(e){ix=((e.pageY/el.height)*lines)>>0;if (ix<=msgs.length)index=ix;if (index<1)index=1; rsz();};

function widgets(ctx){var fsize=el.height/lines;
//list
var ty=1.5;
  for (var m in msgs){drawText(msgs[m], fsize, "nrm","#ddd",30,ty++*(fsize)); if (ty==1.5)ty=2.;}
//label
var ttle=window.orientation ? 20 : 30;
var subt=window.orientation ? 10  : 15;
  ctx.beginPath();  ctx.strokeStyle="#99aabb";  ctx.lineWidth=1;
  ctx.moveTo(0,el.height*0.67);ctx.lineTo(el.width,el.height*0.67);
  ctx.closePath();  ctx.stroke();
 // ctx.beginPath(); ctx.moveTo(el.width*0.02,el.height*0.02);ctx.lineTo(el.width*0.35,el.height*0.02);
 // ctx.closePath(); ctx.stroke();
  //drawText("Whole (64bits)",ttle , "nrm", "#fff", 10, tc.height*0.66-ttle);
  drawText(msgs[index-1].substring(1), subt, "nrm", "#ddd", 20, tc.height*0.675);
//media keys
var btnsize=window.orientation ? 40:60, clr="#ccc",clz="#000";
  //right
//  drawCircle(btnsize*2,0,btnsize+btnsize/10,clr);drawCircle(btnsize*2,0,btnsize,clz);
  //left
//  drawCircle(0-btnsize*2,0,btnsize+btnsize/10,clr);drawCircle(0-btnsize*2,0,btnsize,clz);
  //center
//  drawCircle(0,0,btnsize*1.3+btnsize/10,clr);drawCircle(0,0,btnsize*1.3,clz);
}

</script>
</body>



